# プロンプトファイル

このディレクトリには、GitHub Copilot をはじめとしたコード生成ツール用のプロンプトファイルが格納されています。これらのファイルは再利用可能なプロンプトを定義し、VS Code の Copilot Chat で手動実行可能なプロンプトとして機能します。チーム全体で一貫した品質を保つための共有リソースです。

## プロンプトファイルについて

プロンプトファイルは、VS Code の GitHub Copilot Chat で使用される機能です（2024年現在、実験的機能として提供）。特定のタスクに対する再利用可能なプロンプトを定義し、チーム間で共有することができます。これらのプロンプトは汎用的な形式で記述されており、他の開発ツールでも応用可能です。

**重要**: このディレクトリのファイルは、GitHub Copilot の自動カスタムインストラクション機能ではなく、手動実行用のプロンプトファイルとして設計されています。自動適用はされないため、必要に応じて明示的に実行する必要があります。

### 対応環境

- VS Code の GitHub Copilot Chat（v0.22.4以降推奨）
- `.github/prompts` フォルダに配置されたワークスペースプロンプトファイル
- 汎用的なプロンプト形式のため、他のコード生成ツールでも応用可能

### GitHub Copilot カスタムインストラクションとの違い

**プロンプトファイル（このディレクトリ）**:

- 手動で呼び出す再利用可能なプロンプト
- `.github/prompts/` ディレクトリに配置
- 設定要：`"chat.promptFiles": true`

**カスタムインストラクション（別機能）**:

- リポジトリ全体に自動適用される指示
- `.github/copilot-instructions.md` または `.github/instructions/` ディレクトリ
- 設定要：`"github.copilot.chat.codeGeneration.useInstructionFiles": true`

### 前提条件

VS Code でプロンプトファイルを使用するには、以下の設定が必要です：

1. **ワークスペース設定の有効化**
   - VS Code で `Ctrl+Shift+P`（Windows/Linux）または `Cmd+Shift+P`（Mac）でコマンドパレットを開く
   - "Open Workspace Settings (JSON)" を選択
   - `settings.json` に以下を追加:
     ```json
     {
       "chat.promptFiles": true
     }
     ```

2. **GitHub Copilot 拡張機能**
   - 最新版の GitHub Copilot 拡張機能がインストールされていること
   - VS Code のバージョンは1.85以上を推奨

## 含まれるプロンプトファイル

| ファイル名                            | 目的                   | 概要                                                           | ファイル形式      | 実行方法 |
| ------------------------------------- | ---------------------- | -------------------------------------------------------------- | ----------------- | -------- |
| `codeGeneration.md`                   | コード生成             | プロジェクトのコーディング標準に従ったコード生成の指示         | シンプル (.md)    | 手動     |
| `codeReview.md`                       | コードレビュー         | コードの品質、パフォーマンス、セキュリティに関するレビュー指示 | シンプル (.md)    | 手動     |
| `commitMessageGeneration.md`          | コミットメッセージ生成 | 一貫したフォーマットのコミットメッセージ作成指示               | シンプル (.md)    | 手動     |
| `pullRequestDescriptionGeneration.md` | プルリクエスト説明生成 | プルリクエストのタイトルと説明文の作成指示                     | シンプル (.md)    | 手動     |
| `testGeneration.md`                   | テスト生成             | ユニットテストの作成とベストプラクティスの指示                 | シンプル (.md)    | 手動     |
| `comment-rule.prompt.md`              | コメント記述           | JSDoc形式のコメント記述ルールと原則                            | 高度 (.prompt.md) | 手動     |
| `styling-rule.prompt.md`              | スタイリング           | PandaCSS を使用したスタイリングの原則と規約                    | 高度 (.prompt.md) | 手動     |

**注意**: すべてのファイルは手動実行が必要です。自動適用はされません。

## プロンプトファイルの使用方法

### 1. アタッチメント機能での実行

- チャット入力欄の📎アイコンをクリック
- 「Prompt...」を選択
- 使用したいプロンプトファイルを選択

### 2. コマンドパレットから実行

- `Ctrl+Shift+P`（Windows/Linux）または `Cmd+Shift+P`（Mac）でコマンドパレットを開く
- "Chat: Run Prompt" を選択
- プロンプトファイルを選択

### 3. エディターから直接実行

- プロンプトファイルをエディターで開く
- タイトルバーの再生ボタン（▶️）をクリックして実行

### 4. チャット入力欄から直接実行

- チャット入力欄に `/prompt-ファイル名` と入力する（拡張子なし）
- 例：`/prompt-codeGeneration` と入力して codeGeneration.md を実行

## プロンプトファイルの構造

このディレクトリには2つの形式のファイルがあります：

### 1. シンプルなプロンプトファイル（`.md`）

基本的なMarkdown形式で記述されたファイル：

```markdown
# プロンプトのタイトル

ここにMarkdown形式でプロンプトの指示を記述する。
```

### 2. 高度なプロンプトファイル（`.prompt.md`）

Front Matter を含む、より詳細な設定が可能なファイル：

```markdown
---
description: "プロンプトの説明"
mode: "ask" | "edit" | "agent"
model: "使用するAIモデル（オプション）"
tools: ["使用可能なツール（オプション）"]
---

# プロンプトの内容

ここにMarkdown形式でプロンプトの指示を記述する。
```

### メタデータ（Front Matter）

- `description`: プロンプトの簡潔な説明
- `mode`: チャットモード（`ask`, `edit`, `agent`のいずれか、デフォルトは`agent`）
- `model`: 使用するAIモデル（省略時は現在選択されているモデルを使用）
- `tools`: エージェントモードで使用可能なツールの配列
- `applyTo`: プロンプトを自動適用するファイルパターン（例：`"**/*.ts"`, `"**/*.js"`）

### プロンプト内容

- Markdown形式でプロンプトの指示を記述
- `#file:../../web/index.ts` 構文でファイル参照が可能（相対パス）
- Markdownリンクでの参照も可能：`[index](../../web/index.ts)`
- 複数ファイルの内容をプロンプト内で直接参照可能
- 明確な指示と具体例を含めることで理解を促進

## プロジェクト固有の指示

これらのプロンプトファイルは、本プロジェクトの技術スタックと開発方針に合わせて設計されています：

- **Next.js 15.x App Router**: プロジェクトアーキテクチャに準拠したコード生成
- **TypeScript**: 型安全性を重視したコード品質
- **PandaCSS**: プロジェクト専用のスタイリングシステム
- **日本語対応**: 日本語コンテンツとコメントのサポート
- **多段階ビルドプロセス**: プリビルドフェーズを含む複雑なビルドパイプライン

これらの技術的な情報は、コード生成ツールがプロジェクトに最適化された出力を行うための基礎情報として提供されます。

## カスタマイズ

プロンプトファイルはプロジェクトの要件に応じてカスタマイズ可能です。新しいプロンプトファイルを追加する場合は：

1. `.github/prompts` ディレクトリに `.md` または `.prompt.md` ファイルを作成
   - **シンプルなプロンプト**: `.md` 拡張子を使用
   - **高度な設定が必要**: `.prompt.md` 拡張子でFront Matterを含める
2. 適切な内容とプロンプト指示を記述
   - 明確な構造と具体例を含める
   - 複雑な指示は段階的に説明
   - 専門用語には簡潔な説明を添える
3. VS Code でファイルが認識されることを確認

## 自動カスタムインストラクションについて

このディレクトリのファイルとは別に、GitHub Copilot には自動適用される **カスタムインストラクション** 機能があります：

### カスタムインストラクションの設定

リポジトリ全体に自動適用される指示を設定するには：

1. **単一ファイル方式**: `.github/copilot-instructions.md` を作成
2. **複数ファイル方式**: `.github/instructions/` ディレクトリに `.instructions.md` ファイルを作成

### VS Code設定

カスタムインストラクションを有効にするには：

```json
{
  "github.copilot.chat.codeGeneration.useInstructionFiles": true
}
```

現在のプロジェクトでは、`.github/copilot-instructions.md` に全体的な開発ガイドラインが設定されています。

## 注意事項

- プロンプトファイルは実験的機能のため、仕様が変更される可能性があります
- **手動実行が必要**: このディレクトリのファイルは原則的に手動で実行します
  - `applyTo`メタデータを使えば特定ファイルパターンに適用も可能ですが、本プロジェクトでは明示的な実行を推奨
- チャット要求には自動的に含まれないため、必要に応じて明示的に選択して使用します
- チーム間での一貫性を保つため、プロンプトファイルの変更時は適切なコードレビューを実施することを推奨します
- VS Code の設定で `chat.promptFiles` を有効にしておく必要があります
- 明確な指示と具体例を含めることで、高品質な出力結果を得られます

## 関連リソース

- [GitHub Copilot カスタムインストラクション公式ドキュメント](https://docs.github.com/en/copilot/customizing-copilot/adding-custom-instructions-for-github-copilot)
- [VS Code プロンプトファイル公式ドキュメント](https://code.visualstudio.com/docs/copilot/copilot-customization#_reusable-prompt-files-experimental)
- [プロジェクト固有の開発ガイドライン](/.github/copilot-instructions.md)
- [VS Code Copilot カスタマイズガイド](https://code.visualstudio.com/docs/editor/github-copilot)

## プロンプトファイルの管理

プロンプトファイルはチームで共有されるリソースであるため、以下の点に注意して管理してください：

1. 新しいプロンプトファイルを作成する場合は、チームでレビューを行う
2. プロンプトの内容は定期的にメンテナンスし、最新のプロジェクト状況を反映させる
3. 一般的な内容はカスタムインストラクション（`.github/copilot-instructions.md`）に、特定タスク用の指示はこのディレクトリに配置する
4. 品質向上のため、以下の要素を含めるよう心がける:
   - 明確な構造と見出し
   - 具体例と反例
   - 技術用語の簡潔な説明
   - 段階的な指示
