# コードレビューの指示

コードレビューを行う際には、以下のチェックポイントに従って評価・改善提案を行ってください。このガイドラインは、プロジェクトの品質維持と向上に役立つ具体的なレビュー方法を提供します。

## プロジェクト固有の観点

### 1. アーキテクチャ準拠

- **App Router構造**: ルートグループ `(ArchivePage)`, `(PostPage)`, `(SinglePage)` の適切な使用
- **コンポーネント分類**: `Page/`, `UI/`, `Functional/`, `App/` の正しい配置
- **パスマッピング**: `@/*` (src配下), `~/*` (プロジェクトルート) の適切な使用

### 2. スタイリング規則

- **PandaCSS**: テンプレートリテラル構文の使用
- **ゼロマージン原則**: コンポーネントが自身のマージンを設定していないか
- **レスポンシブ対応**: モバイルファーストの実装

### 3. パフォーマンス

- **静的生成**: `generateStaticParams` の適切な実装
- **画像最適化**: Next.js Image コンポーネントの使用
- **バンドルサイズ**: 不要なimportやライブラリの使用

## 技術スタック固有のチェック

### TypeScript

- **型安全性**: `any` の使用を避け、適切な型定義
- **Result型**: エラーハンドリングでの関数型アプローチ
- **パスマッピング**: 絶対パスでのimport

### Next.js 15.x

- **App Router**: `page.tsx`, `layout.tsx`, `loading.tsx` の適切な使用
- **メタデータAPI**: SEO最適化の実装
- **サーバーコンポーネント**: クライアントコンポーネントとの適切な分離

### 日本語コンテンツ処理

- **文字エンコーディング**: UTF-8の適切な処理
- **形態素解析**: kuromoji使用時の効率的な実装
- **TF-IDF計算**: パフォーマンス最適化

## レビュー手順

### 1. 必須チェック項目

```
□ コンパイルエラーがない
□ 型エラーが解消されている
□ Biome (Linter) の警告が解消されている
□ 未使用のインポート/変数がない
□ 適切なJSDocとコメントが付けられている
□ テストが存在し、パスしている
```

### 2. 品質評価（優先度順）

1. **機能性**: 要件を満たしているか
   - 仕様書や要求書との一致性
   - エッジケースの処理
   - エラーハンドリングの完全性

2. **可読性**: 命名・構造・コメントの適切性
   - 理解しやすい命名規則
   - 適切な関数の分割とコンポーネント設計
   - コメントの品質と量

3. **保守性**: 変更に対する影響範囲の最小化
   - テストカバレッジ
   - コードのモジュール性
   - 依存関係の明確性

4. **パフォーマンス**: 実行速度・メモリ使用量
   - 不要な再レンダリングの回避
   - リソースの適切な利用
   - ボトルネックの有無

5. **セキュリティ**: XSS、CSRF等の脆弱性
   - 入力データの検証
   - 権限チェック
   - 機密情報の適切な取り扱い

### 3. 改善提案の形式

````markdown
## 🔍 指摘事項

### ❌ 問題
具体的な問題の説明

### ✅ 改善案

```typescript
// 修正前
const badCode = ...

// 修正後
const goodCode = ...
```

### 📝 理由
改善が必要な理由とメリット

### 💡 参考情報
- [関連ドキュメントやベストプラクティスへのリンク]
- [パターンや手法の説明]
````

### 4. 具体的なレビュー例

````markdown
## 🔍 型安全性の改善

### ❌ 問題
`any` 型が使用されており、型安全性が確保されていません。

### ✅ 改善案

```typescript
// 修正前
function processData(data: any) {
  return data.value;
}

// 修正後
interface DataWithValue {
  value: string;
}

function processData(data: DataWithValue) {
  return data.value;
}
```

### 📝 理由
明確な型定義を行うことで、実行時エラーを防止し、コードの自己文書化にも役立ちます。また、IDEのサポートも得られます。
````

## プロジェクト特有の注意点

### ビルドプロセス
- **プリビルドスクリプトへの影響**: 変更が`npm run prebuild`に与える影響を考慮
- **JSON生成処理の整合性**: 記事データの生成処理が正しいか
- **OGP画像生成への影響**: 画像生成の動作への影響がないか

### コンテンツ処理
- **Markdown解析の精度**: 記事の構造が正しく解析されているか
- **類似度計算の正確性**: 関連記事の特定が正しく機能しているか
- **静的ファイル生成の効率性**: ビルド時間やリソース消費が最適化されているか

### 開発体験
- **開発サーバーの動作**: ローカル開発環境での動作を確認
- **ホットリロードの対応**: 適切なホットリロードが機能しているか
- **デバッグ情報の適切性**: エラーメッセージやログが明確であるか

### セキュリティとパフォーマンス
- **XSS脆弱性**: 特に`dangerouslySetInnerHTML`の使用箇所を確認
- **リソース最適化**: 画像、CSS、JavaScriptのバンドルが最適化されているか
- **アクセシビリティ**: スクリーンリーダー互換性が確保されているか
```
